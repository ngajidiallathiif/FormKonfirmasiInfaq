<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Form Pembayaran Infaq</title>

<style>
    body { font-family: 'Lexend', sans-serif; background: #f5f5f5; }
    .container { max-width: 450px; margin: 20px auto; background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .dropdown-list { 
        border: 1px solid #ccc; max-height: 180px; overflow-y: auto; 
        display: none; border-radius: 8px; margin-top: 5px;
    }
    .dropdown-item {
        padding: 8px; cursor: pointer; background: white;
    }
    .dropdown-item:hover { background: #efefef; }
    input, button {
        width: 100%; padding: 10px; margin: 8px 0; border-radius: 8px; border: 1px solid #ccc;
    }
    button { background: #0066ff; color: white; font-weight: bold; cursor: pointer; }
</style>
</head>
<body>

<div class="container">

    <h3 style="text-align:center;margin-bottom:20px;">Form Pembayaran Infaq<br>Kuttab Mentoring</h3>

    <!-- INPUT NAMA + DROPDOWN -->
    <label>Nama Member</label>
    <input type="text" id="namaMember" autocomplete="off" placeholder="Ketik nama...">
    <div id="dropdown" class="dropdown-list"></div>

    <label>Nomor WhatsApp</label>
    <input type="text" id="wa" readonly>

    <label>Jenis Kelamin</label>
    <input type="text" id="jk" readonly>

    <label>Nomor Kelas</label>
    <input type="text" id="kelas" readonly>

    <label>Nama Mentor</label>
    <input type="text" id="mentor" readonly>

    <button id="resetBtn" style="background:#999;margin-top:10px;">Reset Pilihan</button>

    <button id="submitBtn">Lanjut Isi di Google Form</button>

</div>


<script>
// =======================
// 1. Ambil data dari Spreadsheet
// =======================
const SHEET_TSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRJsoLmoRr2EWDG7b-vUI0DwEqtWb2RIlJgFY_oG0auz0KUd2P47g95dM3eyKn5Y1XMTfpiNlT3072j/pub?gid=0&single=true&output=tsv"

let memberList = [];

async function loadSheet() {
    const res = await fetch(SHEET_TSV_URL);
    const text = await res.text();
    const rows = text.trim().split("\n").map(r => r.split("\t"));
    rows.shift(); // Remove header

    memberList = rows.map(r => ({
        nama: r[0],
        wa: r[1],
        jk: r[2],
        kelas: r[3],
        mentor: r[4]
    }));
}
loadSheet();

// =======================
// 2. Dropdown Pencarian
// =======================
const namaInput = document.getElementById("namaMember");
const dropdown = document.getElementById("dropdown");

namaInput.addEventListener("input", function () {
    const keyword = this.value.toLowerCase();
    dropdown.innerHTML = "";
    dropdown.style.display = "block";

    let filtered = memberList.filter(m => m.nama.toLowerCase().includes(keyword));

    filtered.forEach(m => {
        let item = document.createElement("div");
        item.classList.add("dropdown-item");
        item.textContent = m.nama;
        item.onclick = () => selectMember(m);
        dropdown.appendChild(item);
    });
});

// =======================
// 3. Klik input â†’ kosongkan otomatis agar bisa pilih ulang
// =======================
namaInput.addEventListener("focus", function () {
    this.value = "";
    dropdown.style.display = "block";
});

// =======================
// 4. Ketika memilih nama
// =======================
function selectMember(m) {
    namaInput.value = m.nama;
    document.getElementById("wa").value = m.wa;
    document.getElementById("jk").value = m.jk;
    document.getElementById("kelas").value = m.kelas;
    document.getElementById("mentor").value = m.mentor;
    dropdown.style.display = "none";
}

// =======================
// 5. Tombol Reset
// =======================
document.getElementById("resetBtn").onclick = () => {
    namaInput.value = "";
    wa.value = "";
    jk.value = "";
    kelas.value = "";
    mentor.value = "";
    dropdown.innerHTML = "";
    dropdown.style.display = "none";
    namaInput.focus();
};

// =======================
// 6. Tombol lanjut Google Form
// =======================
document.getElementById("submitBtn").onclick = () => {
    alert("Integrasi ke Google Form bisa ditambahkan.");
};
</script>

</body>
</html>
